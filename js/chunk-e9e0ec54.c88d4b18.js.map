{"version":3,"sources":["webpack:///./src/views/login/index.vue?7df1","webpack:///./src/views/login/index.vue?59c1","webpack:///src/views/login/index.vue","webpack:///./src/views/login/index.vue?e0c5","webpack:///./src/views/login/index.vue?68eb","webpack:///./src/api/user.js"],"names":["render","_vm","this","_h","$createElement","_c","_self","staticClass","attrs","on","$event","$router","go","errorMessage","mobile","checkMobile","model","value","loginFrom","callback","$$v","$set","trim","expression","code","checkCode","slot","_v","login","staticRenderFns","data","methods","test","component","request","url","method","followUser","unfollowUser","id","getuserInfo","getUserprofile","updatePhoto","saveUserInfo","photo"],"mappings":"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","file":"js/chunk-e9e0ec54.c88d4b18.js","sourcesContent":["import mod from \"-!../../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--6-oneOf-1-0!../../../node_modules/css-loader/dist/cjs.js??ref--6-oneOf-1-1!../../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../../node_modules/postcss-loader/src/index.js??ref--6-oneOf-1-2!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./index.vue?vue&type=style&index=0&lang=css&\"; export default mod; export * from \"-!../../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--6-oneOf-1-0!../../../node_modules/css-loader/dist/cjs.js??ref--6-oneOf-1-1!../../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../../node_modules/postcss-loader/src/index.js??ref--6-oneOf-1-2!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./index.vue?vue&type=style&index=0&lang=css&\"","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',{staticClass:\"container\"},[_c('van-nav-bar',{attrs:{\"title\":\"登录\",\"left-arrow\":\"\"},on:{\"click-left\":function($event){return _vm.$router.go(-1)}}}),_c('van-cell-group',[_c('van-field',{attrs:{\"error-message\":_vm.errorMessage.mobile,\"placeholder\":\"请输入手机号\",\"label\":\"手机号\"},on:{\"blur\":_vm.checkMobile},model:{value:(_vm.loginFrom.mobile),callback:function ($$v) {_vm.$set(_vm.loginFrom, \"mobile\", (typeof $$v === 'string'? $$v.trim(): $$v))},expression:\"loginFrom.mobile\"}}),_c('van-field',{attrs:{\"error-message\":_vm.errorMessage.code,\"placeholder\":\"请输入验证码\",\"label\":\"验证码\"},on:{\"blur\":_vm.checkCode},model:{value:(_vm.loginFrom.code),callback:function ($$v) {_vm.$set(_vm.loginFrom, \"code\", (typeof $$v === 'string'? $$v.trim(): $$v))},expression:\"loginFrom.code\"}},[_c('van-button',{attrs:{\"slot\":\"button\",\"size\":\"small\",\"type\":\"primary\"},slot:\"button\"},[_vm._v(\"发送验证码\")])],1)],1),_c('div',{staticClass:\"login-box\"},[_c('van-button',{attrs:{\"type\":\"info\",\"block\":\"\",\"round\":\"\",\"size\":\"small\"},on:{\"click\":_vm.login}},[_vm._v(\" 登录 \")])],1)],1)}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","<template>\r\n   <!-- 登录 -->\r\n  <div class=\"container\">\r\n      <!-- 头部导航栏 左箭头left-arrow -->\r\n      <van-nav-bar title=\"登录\"  left-arrow @click-left=\"$router.go(-1)\"></van-nav-bar>\r\n      <!-- 登录模块 布局 -->\r\n      <van-cell-group>\r\n        <!-- 手机号 -->\r\n       <van-field @blur=\"checkMobile\" :error-message=\"errorMessage.mobile\" v-model.trim=\"loginFrom.mobile\" placeholder=\"请输入手机号\" label=\"手机号\"></van-field>\r\n       <!-- 验证码 -->\r\n       <van-field @blur=\"checkCode\" :error-message=\"errorMessage.code\" v-model.trim=\"loginFrom.code\" placeholder=\"请输入验证码\" label=\"验证码\">\r\n         <!-- 验证码 按钮 -->\r\n         <van-button slot=\"button\" size=\"small\" type=\"primary\">发送验证码</van-button>\r\n       </van-field>\r\n      </van-cell-group>\r\n        <!-- 登录按钮 -->\r\n        <div class=\"login-box\">\r\n        <van-button @click=\"login\" type=\"info\" block round size=\"small\"> 登录 </van-button>\r\n        </div>\r\n  </div>\r\n</template>\r\n\r\n<script>\r\nimport { login } from '@/api/user.js'\r\nimport { mapMutations } from 'vuex' // 辅助函数 可以把mutations方法映射到methods方法中\r\nexport default {\r\n  data () {\r\n    return {\r\n    // 表单数据\r\n      loginFrom: {\r\n        mobile: '13911111111', // 手机号\r\n        code: '246810' // 验证码\r\n      },\r\n      errorMessage: { // 定义一个 对象专门存放 错误消息\r\n        mobile: '', // 手机号错误消息\r\n        code: '' // 验证码 错误消息\r\n      }\r\n    }\r\n  },\r\n  methods: {\r\n    ...mapMutations(['updataUser']),\r\n    // 定义一个检查手机号的方法\r\n    checkMobile () {\r\n      // 获取手机号 校验是否为空\r\n      if (!this.loginFrom.mobile) {\r\n        this.errorMessage.mobile = '手机号不能为空'\r\n        return false // return 一个 false 表示此校验没有通过\r\n      }\r\n      // 正则 校验格式是否正确\r\n      if (!/^1[3-9]\\d{9}$/.test(this.loginFrom.mobile)) {\r\n        this.errorMessage.mobile = '手机号格式不正确'\r\n        return false\r\n      }\r\n      // 如果到了 这个位置了 就说明 之前的校验都通过了\r\n      this.errorMessage.mobile = '' // 通过了 就没有消息了\r\n      return true\r\n    },\r\n    // 定义一个 检查验证码的方法\r\n    checkCode () {\r\n      // 获取 验证码 校验是否为空\r\n      if (!this.loginFrom.code) {\r\n        this.errorMessage.code = '验证码不能为空'\r\n        return false // return 一个 false 表示此校验没有通过\r\n      }\r\n      // 正则 校验格式是否正确\r\n      if (!/^\\d{6}$/.test(this.loginFrom.code)) { // 摘要 /^\\d{6}$/.test(this.loginFrom.code ! ! ! !\r\n        this.errorMessage.code = '验证码必须为6位数字'\r\n        return false\r\n      }\r\n      // 如果到了 这个位置了 就说明 之前的校验都通过了\r\n      this.errorMessage.code = '' // 通过了 就没有消息了\r\n      return true\r\n    },\r\n    // 点击登陆时 手动校验表单\r\n    async login () {\r\n      const validateMobile = this.checkMobile()\r\n      const validateCode = this.checkCode()\r\n      if (validateMobile && validateCode) {\r\n        // 当手机号 失败的时候 我们需要 捕获错误 用 try catch\r\n        try {\r\n          const ser = await login(this.loginFrom) // 调用接口 给接口传入 请求 参数\r\n          // Vuex 的简化写法 结构出一个方法\r\n          this.updataUser({ user: ser }) // 相当于 更新了 token 和 refresh_token\r\n          // 判断是否有新的跳转页面\r\n          const { redirectUrl } = this.$route.query // query 查询参数 也就是 ？ 后面的参数地址 里面有个 redirectUrl 地址变量 这个变量 也就是我要 跳转的地址\r\n          this.$router.push(redirectUrl || '/')\r\n          this.$notify({ type: 'success', message: '登陆成功', duration: 800 })\r\n        } catch (error) {\r\n          // 需要提示 捕获到的错误消息 告诉用户 登陆失败\r\n          this.$notify({ message: '登陆失败', duration: 800 })\r\n        }\r\n      }\r\n    }\r\n  }\r\n}\r\n</script>\r\n\r\n<style>\r\n.login-box{\r\npadding: 15px;\r\n}\r\n</style>\r\n","import mod from \"-!../../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../../node_modules/thread-loader/dist/cjs.js!../../../node_modules/babel-loader/lib/index.js!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./index.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../../node_modules/thread-loader/dist/cjs.js!../../../node_modules/babel-loader/lib/index.js!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./index.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./index.vue?vue&type=template&id=13b08d2b&\"\nimport script from \"./index.vue?vue&type=script&lang=js&\"\nexport * from \"./index.vue?vue&type=script&lang=js&\"\nimport style0 from \"./index.vue?vue&type=style&index=0&lang=css&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  null,\n  null\n  \n)\n\nexport default component.exports","/**\r\n *      一个专门处理 用户数据信息的请求模块 文件\r\n */\r\n// 引入 请求模块\r\nimport request from '@/utils/request.js'\r\n// 应该先 导出一个方法 登录方法\r\nexport function login (data) {\r\n  // request 相当于 axios 实例 拥有和 axios 同样的功能\r\n  return request({\r\n    // 配置参数\r\n    url: '/authorizations', // 请求地址\r\n    method: 'post', // 请求类型\r\n    data // ES6 简写模式\r\n  })\r\n}\r\n/**\r\n *    关注用户\r\n */\r\nexport function followUser (data) {\r\n  return request({\r\n    url: '/user/followings', // 关注用户 接口地址\r\n    data, // 请求参数\r\n    method: 'post' // 请求类型\r\n  })\r\n}\r\n/**\r\n *    取消关注用户\r\n */\r\nexport function unfollowUser (id) {\r\n  return request({\r\n    url: `/user/followings/${id}`,\r\n    method: 'DELETE' // 取消 关注接口类型\r\n  })\r\n}\r\n/**\r\n *    获取用户的 个人资料\r\n */\r\nexport function getuserInfo () {\r\n  return request({\r\n    url: '/user'\r\n  })\r\n}\r\n/**\r\n *    获取个人用户资料\r\n */\r\nexport function getUserprofile () {\r\n  return request({\r\n    url: '/user/profile' // 获取用户个人资料的 接口地址\r\n  })\r\n}\r\n/**\r\n *    修改用户 头像\r\n */\r\nexport function updatePhoto (data) {\r\n  return request({\r\n    url: '/user/photo', // 修改用户 头像 接口\r\n    data, // 参数\r\n    method: 'patch'\r\n  })\r\n}\r\n/**\r\n *    保存用户 信息\r\n */\r\nexport function saveUserInfo (data) {\r\n  return request({\r\n    url: '/user/profile',\r\n    method: 'patch',\r\n    data: { ...data, photo: null } // 意思是 直接将 头像 设置为空\r\n  })\r\n}\r\n"],"sourceRoot":""}